<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0078)http://www.oi.edu.pl/php/show.php?ac=e171100&module=show&file=zadania/oi13/okr -->
<HTML><HEAD><TITLE>Polish Olympiad in Informatics</TITLE>
<META content="Peter Stañczyk (stanczyk@absurd.mimuw.edu.pl)" name=Author>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-2"><LINK 
href="okr.files/style.css" type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2900.2802" name=GENERATOR></HEAD>
<BODY text=black leftMargin=0 background=okr.files/oil1.gif topMargin=0 
marginwidth="0" marginheight="0">
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR bgColor=#336699>
    <TD weight="145">&nbsp;</TD>
    <TD width=1000 height=20>
      <CENTER><IMG src="okr.files/oie.gif"></CENTER></TD>
    <TD align=right><A 
      href="http://www.oi.edu.pl/php/show.php?ac=p171100"><IMG 
      alt="Polish version" src="okr.files/pl.gif" border=0></A>&nbsp; &nbsp; <A 
      href="http://www.oi.edu.pl/php/show.php?ac=e171100"><IMG 
      alt="English version" src="okr.files/uk.gif" border=0></A> &nbsp;</TD></TR>
  <TR>
    <TD background=okr.files/mt2.gif colSpan=2 height=21>
      <TABLE cellSpacing=0 cellPadding=0 width=130 align=left border=0 
      valign="top">
        <TBODY>
        <TR>
          <TD noWrap background=okr.files/mro.gif bgColor=#336699><FONT 
            color=white><B>&nbsp; XIII OI 2005/2006</B></FONT></TD>
          <TD><IMG src="okr.files/mrog.gif"></TD></TR></TBODY></TABLE></TD>
    <TD vAlign=top align=right rowSpan=2><IMG height=90 
      src="okr.files/logo.gif" width=100 rowspan="2"></TD></TR>
  <TR>
    <TD vAlign=top weight="145"><IMG height=0 src="okr.files/blok.gif" 
      width=145> <BR><BR>
      <TABLE cellSpacing=0 cellPadding=0 width=138 align=left border=0>
        <TBODY>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e150000">News</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e160000">About 
          Olympic</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD align=middle background=okr.files/level0_round.gif bgColor=#336699 
          height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e170000">XIII OI 
            2005/2006</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e170900">News</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171000">Schedule</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171100">Problems</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171200">Stage 
        II</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171300">Stage 
        III</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171500">Stage II - 
            results</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171600">Stage I - 
            results</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_sub.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171700">Regulations</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_sub.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171800">For 
            contestants</A></TD></TR>
        <TR height=2>
          <TD></TD></TR>
        <TR>
          <TD class=c20t width=138 background=okr.files/level1_regular.gif 
          bgColor=#ccdcec height=21><A class=c20 
            href="http://www.oi.edu.pl/php/show.php?ac=e171900">Helpful 
            resources</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e180000">History of 
          OI</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e190000">OI 
        books</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e200000">National 
          team</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e220000">Olympic 
          camps</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e230000">Photo 
          gallery</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 
            href="http://www.oi.edu.pl/php/show.php?ac=e310000">Links</A></TD></TR>
        <TR height=3>
          <TD></TD></TR>
        <TR>
          <TD background=okr.files/level0_regular.gif bgColor=#336699 
            height=21>&nbsp;<A class=c10 href="http://sio.mimuw.edu.pl/" 
            target=_new>SIO</A></TD></TR></TBODY></TABLE></TD>
    <TD vAlign=top>
      <H1>Task: Periods of Words</H1>Available memory: 32 MB 
      <HR>

      <P>A <SPAN class=textit>string</SPAN> is a finite sequence of lower-case 
      (non-capital) letters of the English alphabet. Particularly, it may be an 
      empty sequence, i.e. a sequence of 0 letters. By <SPAN class=MATH><I>A</I> 
      = <I>BC</I></SPAN> we denotes that <SPAN class=MATH><I>A</I></SPAN> is a 
      string obtained by concatenation (joining by writing one immediately after 
      another, i.e. without any space, etc.) of the strings <SPAN 
      class=MATH><I>B</I></SPAN> and <SPAN class=MATH><I>C</I></SPAN> (in this 
      order). A string <SPAN class=MATH><I>P</I></SPAN> is <SPAN class=textit>a 
      prefix of the</SPAN> string <SPAN class=MATH><I>A</I></SPAN>, if there is 
      a string <SPAN class=MATH><I>B</I></SPAN>, that <SPAN class=MATH><I>A</I> 
      = <I>PB</I></SPAN>. In other words, prefixes of <SPAN 
      class=MATH><I>A</I></SPAN> are the initial fragments of <SPAN 
      class=MATH><I>A</I></SPAN>. In addition, if <SPAN class=MATH><I>P</I> <IMG 
      alt="$ \neq$% WIDTH=16 HEIGHT=30 " src="okr.files/okrzad-img1.png" 
      align=middle> <I>A</I></SPAN> and <SPAN class=MATH><I>P</I></SPAN> is not 
      an empty string, we say, that <SPAN class=MATH><I>P</I></SPAN> is <SPAN 
      class=textit>a proper prefix of</SPAN> <SPAN class=MATH><I>A</I></SPAN>. 
      </P>
      <P>A string <SPAN class=MATH><I>Q</I></SPAN> is a <SPAN 
      class=textit>period</SPAN> of <SPAN class=MATH><I>A</I></SPAN>, if <SPAN 
      class=MATH><I>Q</I></SPAN> is a proper prefix of <SPAN 
      class=MATH><I>A</I></SPAN> and <SPAN class=MATH><I>A</I></SPAN> is a 
      prefix (not necessarily a proper one) of the string <SPAN 
      class=MATH><I>QQ</I></SPAN>. For example, the strings <TT>abab</TT> and 
      <TT>ababab</TT> are both periods of the string <TT>abababa</TT>. The <SPAN 
      class=textit>maximum period</SPAN> of a string <SPAN 
      class=MATH><I>A</I></SPAN> is the longest of its periods or the empty 
      string, if <SPAN class=MATH><I>A</I></SPAN> doesn't have any period. For 
      example, the maximum period of <TT>ababab</TT> is <TT>abab</TT>. The 
      maximum period of <TT>abc</TT> is the empty string. </P>
      <P></P>
      <H1>Task </H1>Write a programme that: 
      <UL>
        <LI>reads from the standard input the string's length and the string 
        itself, 
        <LI>calculates the sum of lengths of maximum periods of all its 
        prefixes, 
        <LI>writes the result to the standard output. </LI></UL>
      <P></P>
      <H1>Input </H1>In the first line of the standard input there is one 
      integer <SPAN class=MATH><I>k</I></SPAN> (<!-- MATH
 $1 \le k \le 1\,000\,000$
 --> <SPAN class=MATH>1<IMG 
      alt="$ \le$% WIDTH=16 HEIGHT=30 " src="okr.files/okrzad-img2.png" 
      align=middle><I>k</I><IMG alt="$ \le$% WIDTH=16 HEIGHT=30 " 
      src="okr.files/okrzad-img2.png" align=middle>1&nbsp;000&nbsp;000</SPAN>) 
      -- the length of the string. In the following line a sequence of exactly 
      <SPAN class=MATH><I>k</I></SPAN> lower-case letters of the English 
      alphabet is written -- the string. 
      <P></P>
      <H1>Output </H1>In the first and only line of the standard output your 
      programme should write an integer -- the sum of lengths of maximum periods 
      of all prefixes of the string given in the input. 
      <P></P>
      <H1>Example</H1>For the following input data:<PRE>8
babababa
</PRE>the correct answer is:<PRE>24
</PRE><BR><BR>
      <CENTER><A 
      href="http://www.oi.edu.pl/php/show.php?ac=e171100&amp;module=show&amp;file=zadania/oi13/okr&amp;print=yes" 
      target=_new><IMG src="okr.files/print.gif" border=0><BR>Print friendly 
      version</A></CENTER><BR></TD></TR></TBODY></TABLE></BODY></HTML>
