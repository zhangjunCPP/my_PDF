# T1

题目怎么还有问题啊qaq，没看懂。打表找找规律。

然后注意到通项公式
$$
f_i=f_{i-1}+\frac{2f_{i-2}+(i-2)\times(i-2)!}{2}
$$
通项公式的后面一项利用了等差数列求和公式。

初始值
$$
f_3=1, f_4=7
$$
（累qaq）

由于 p 为质数，直接用快速幂求出 2 的逆元，**在迭代时顺便计算阶乘**即可。

**注意边算边模**。可能要开 `long long`，反正我开了。

时间复杂度
$$
\Theta(N)
$$
空间复杂度可以是
$$
\mathcal{O}(1)
$$
的，因为只需要用到前面的两项。但是我懒得写了qaq

（1G的内存应该不会爆吧……）

# T2

qaq怎么都是这种题目啊

感觉可能和树的直径有点关系？

注意到
$$
N\leq10^6
$$
这要求我们至少用
$$
\Theta{\left(N\sqrt{N}\right)}
$$
的小常数算法，或者
$$
\Theta{(N\log{N})}
$$
的算法。个人觉得应该是后者。

理解一下特殊性质：

- 性质A：树退化成链

- 性质B：1 号点的（直接）儿子是 2~N 号点

- 性质C：不知道qaq

先考虑性质A怎么做？

## Subtask1: Testpoint 1（10pts）

考虑暴力枚举。

dfs 枚举每个节点可能的情况，共有 2^n 种可能。

bfs 统计贡献，复杂度 n^2

综上，总复杂度
$$
\Theta{(N^22^N)}
$$
取N=10，最大运行次数=100*1024≈1e5，完全可以通过。

## Subtask2: 性质A（Testpoint 2~4, 30pts）

考虑同色点的最大距离，可以是 1, 2, ..., n-1。

所以答案就是这些加起来乘以2？

即
$$
2\Sigma_{i=1}^{n-1}i
$$
利用等差数列求和公式得
$$
\text{ans}=n(n-1)
$$
但是好像不对欸（样例2）

唔……好像是我想得太简单了，先暴力打个表看看。

暴力打表时间复杂度
$$
\Theta{\left(2N^22^N\right)}
$$
其中 2N^2 耗在计算贡献上，2^N耗在 dfs 上

然后优化下可以去掉常数2。

不知道对不对，看看：

|       n        |  2   |  3   |  4   |  5   |  6   |  7   |  8   |  9   |  10  |
| :------------: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|      ans       |  2   |  12  |  38  | 108  | 278  | 684  | 1622 | 3756 | 8534 |
|     delta'     |  2   |  8   |  14  |  32  |  62  | 128  | 254  | 512  | 1022 |
| 最靠近的二次幂 |  2   |  8   |  16  |  32  |  64  | 128  | 256  | 512  | 1024 |
|    delta''     |      |  0   |  -2  |  0   |  -2  |  0   |  -2  |  0   |  -2  |

注意！是取**两种颜色的贡献的最大值**，而不是**两种颜色贡献最大值之和**！

注意到
$$
f_i=2f_{i-1}+2^{i},\text{if i mod 2 is 1},
$$

$$
f_i=2f_{i-1}+2^i-2, \text{if i mod 2 is 0}
$$



考虑递推。初始值
$$
f_2=2
$$
于是时间复杂度
$$
\Theta{(N)}
$$
~~但是答案似乎对不上qaq~~ 现在对上了，期望得分40。

## Subtask 3：性质B

有 2^n 种情况，每种贡献为 2，故答案显然为
$$
2^{N+1}
$$
时间复杂度
$$
\Theta{(\log{N})}
$$
（快速幂）

## 考虑其他情况

