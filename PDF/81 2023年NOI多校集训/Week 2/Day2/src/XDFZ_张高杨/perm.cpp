/*
T1 perm
��Ȼ�������ݷ�Χ�����Ʋ����ÿ��n��������O(1)���
�����뵽����
���Է���һ��
������Ҫ��ĳ��λ�÷���ĳ����������Ҫ���
ʵ���ϵ����Ƿ���һ�����֣���������ĳЩ���ֵ�λ�ñ�����
���ǻᷢ�֣������Ǹ�������ʵ��ȫ���������ƣ��Ͼ������һλ�˻������ʲô����ô��
�������������һλʱ���ݱ��n-1�����
�ᷢ����������Ҳһ�������ǻ���n*f[n-1]
��ʱ���ֻ��ж���Ĺ�����Դ
�г�����3 12 40 150 ...
����ȥ��Щ���ֺ�����
��Щ����ԴӦ�þ���������д������
����������д���Ҳ�ܹ�O(1)����Ļ�����һ���ֿ϶����м���ѭ��
3*1 4*3 5*8 6*25
ϸƷ��1 3 8 25 ...
�о����ж���Ŷ
�Ҿ�����Ӧ������������Ǹ������Ǵ��������ģ�����˵������ʵ�����Ǵ����

���˸�����֤����ȷӦ����һ����������n<=10���ڶ������������
������������֮��õ����������£�
0 0 1 3 8 25 78 266 928 ...
˵ʵ�����Ҿ���Ӧ�ô��������֣������Ʋ�������ֻ�ܳ���Ӳ��

����
����

�ֳ���һ�����������
������𰸻ᷢ��������
1 2 5 17 73 398 ...
���1 3 8 25 78 266 ...
�м�Ķ��׵Ȳ��м��ߵ����ƶ�
�м�Ĳ�ֵ�������ᷢ��
0 0 0 20 210 1974 ...
�ð�����ȫ����Ϊ���й���

���ҳ���
���ں�С�ڵ�������ȫ��ͬ...
ţ�ƣ�
��һ�����ǵ��ص�������ȫ��ͬ�Ĵ�
1 2 4 10 26 76 232 764 2620 9496
˼����ȫ��ͬ�������ô����
Ҫô��ԭ������ȫ��ͬ����ֱ�Ӽ̳�
Ҫô��ԭ����һ�㣬���ֲ�����

��ʵ
Ҫô�Ƕ�Ԫ����Ҫô���Ի�
��ǰ��ĳ��Ԫ���γɶ�Ԫ��
����ֱ���Լ��γ��Ի�
���Դ𰸾���f[n-1]���γ��Ի���+f[n-2]*(n-1)���γɶ�Ԫ����ʣ��ļ����գ� 

���� ���������
���ƺ�ʱ2h50min 07:30-08:50 09:00-10:30

��Ȼ�����ﻹ��һ���д������
���Ĵ���Ҫ�г������㣬��ģ��������֤Ϊ����
���Ժܿ��ܲ�����2�ĳ˷���Ԫ������ʽ����Ҫ��һ���Ż�

�� ����ɵ�� ����mod

����������������ѵĵ�����֮һ��
�Ⱳ�Ӳ��������ڶ��� 
*/
#define ll long long
#include<bits/stdc++.h>
using namespace std;
const int N=10000010;
ll f[N],fac[N],ans,xor_ans;
int n,mod;
inline ll qpow(ll a,ll b)
{
	if(!b)return 1;
	if(!a)return 0;
	ll ret=1;
	while(b)
	{
		if(b&1)(ret*=a)%=mod;
		(a*=a)%=mod;
		b>>=1;
	}
	return ret;
}
int main()
{
	freopen("perm.in","r",stdin);
	freopen("perm.out","w",stdout);
	scanf("%d%d",&n,&mod);
	if(n<3){printf("0");return 0;}
	fac[2]=2,f[1]=1,f[2]=2;
	int inv=qpow(2,mod-2);
	for(int i=3;i<=n;i++)
	{
		fac[i]=fac[i-1]*i%mod;
		f[i]=(f[i-1]+f[i-2]*(i-1)%mod)%mod;
		ans=(fac[i]-f[i]+mod)%mod*inv%mod;
		xor_ans^=ans;
	}
	printf("%lld",xor_ans);
	return 0;
}