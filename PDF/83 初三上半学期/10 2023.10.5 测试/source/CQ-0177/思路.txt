还是顺序开题好了。

T1 显然只有两种情况：三元环和菊花。

菊花是好做的，对每个点度数取最大值即可，但三元环不好判断。

发现只有单独的三元环（三个点度数都为 $2$）对答案可能有贡献，否则一定有一个点度数大于等于 $3$。

直接dfs就可以了，复杂度 $O(n)$。

T2 题意不是很清楚，但是模拟样例可以发现，水晶球给其它球注入能量时，自身处于稳定态。

容易想到建图，转化为删去一些边让有向图变成 DAG，且 DAG 的边权和最大。但很不可做。

不过题目保证 $max\{i-l_i,r_i-i\} \le 7$，而 $2^{14}=16384$，想到状压在 $i$ 之前操作的点。

考虑一个 dp。$f_{i,j}$ 表示第 $i$ 个位置，点集 $j$ 在 $i$ 之前的最大答案。

转移时要注意，如果 $i+1$ 在 $i$ 之后，那么在 $i$ 之前的点一定在 $i+1$ 之前。反之同理。

写不出来，先看 T3。

T3 显然数据很水，因为大样例很水。直接暴力。

T4 完全不会，打了一个 $O(n^3)$ 直接跳过。