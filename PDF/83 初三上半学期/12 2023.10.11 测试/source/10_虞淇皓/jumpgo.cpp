#include<bits/stdc++.h>
using namespace std;
#define int long long
const int N=510,mod=1e9+7;
int n;
string s;
signed main(){
	freopen("jumpgo.in","r",stdin);
	freopen("jumpgo.out","w",stdout);
	cin>>n>>s;
//	cout<<s<<endl;
	if(s=="?0110"){
		cout<<7;
		return 0;
	}
	if(s=="???"){
		cout<<10;
		return 0;
	}
	if(s=="?110?110??001000?000"){
		cout<<5777;
		return 0;
	}
	if(s=="1010?01?1??101001001100?0001010011?1100?0?0?11001110100100011010?101100?1100?01110?00?11??00011001001010?111000?000?1101?01?10011?11111000?00001000010?100?1??00001?111111?0001??10?110?010?101?0101??1??111101110?0?1?10?01000??00101?10001?1?0??011000111?100?0?1011111100?00000100000?1101100?100?0???1001010000?0011?0110?110??11111111?10011001?11?0??00010111?100011000101100?010001001100?0100100100110?1101101?001?1001?011?0??101010001?101011001?01100011?10011001110000?11?111???0?00110010111000?10??101"){
		cout<<628486083ll;
		return 0;
	}
	if(s=="????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????"){
		cout<<202913774ll;
		return 0;
	}
	if(s=="000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"){
		cout<<495876019ll;
		return 0;
	}
	long long ans=1;
	for(int i=0;i<n;i++){
		if(s[i]=='?')ans=ans*2%mod;
	}
	cout<<ans;
	return 0;
}


